\documentclass[electronics,article,submit,pdftex,moreauthors]{Definitions/mdpi} 
%=================================================================
% MDPI internal commands - do not modify
\firstpage{1} 
\makeatletter 
\setcounter{page}{\@firstpage} 
\makeatother
\pubvolume{1}
\issuenum{1}
\articlenumber{0}
\pubyear{2025}
\copyrightyear{2025}
%\externaleditor{Firstname Lastname} % More than 1 editor, please add `` and '' before the last editor name
\datereceived{ } 
\daterevised{ } % Comment out if no revised date
\dateaccepted{ } 
\datepublished{ } 
%\datecorrected{} % For corrected papers: "Corrected: XXX" date in the original paper.
%\dateretracted{} % For retracted papers: "Retracted: XXX" date in the original paper.
\hreflink{https://doi.org/} % If needed use \linebreak
%\doinum{}
%\pdfoutput=1 % Uncommented for upload to arXiv.org
%\CorrStatement{yes}  % For updates
%\longauthorlist{yes} % For many authors that exceed the left citation part
%\IsAssociation{yes} % For association journals

%=================================================================
\usepackage{graphicx}
%=================================================================

\Title{Broadband RF Phased Array Design with MEEP: A 3D-Printed Open-Source RF Horn in the multi-GHz Bandwidth}
\TitleCitation{Title}
\newcommand{\orcidauthorA}{0000-0003-4055-4553}
\Author{Jordan C. Hanson $^{1}$\orcidA{}*, Adam Wildanger$^{1}$}
\AuthorNames{Jordan C. Hanson, Adam Wildanger}
\AuthorCitation{Hanson, J. C.; Wildanger, A.}
\address[1]{$^{1}$ \quad Whittier College, Whittier, CA, USA (www.whittier.edu)}
\corres{Correspondence: jhanson2@whittier.edu}

\abstract{Radio-frequency (RF) antenna design traditionally proceeds in three phases.  First, the design performance is modeled with expensive and proprietary software.  Second, the design is fabricated using intricate metal machining.  Third, the fabricated design is characterized using benchtop RF measurement tools.  The traditional process can include machine learning algorithms for optimization.  We have developed an open-source alternative process that utilizes the MIT Electromagnetic Equation Propagator (MEEP) package for design and simulation, and 3D printing with conductive filament for fabrication.  Using this process, we created and fabricated a broadband RF horn antenna via parametric design.  To characterize our design, we show that the $\mathbf{E}$-plane and $\mathbf{H}$-plane radiation patterns, the VSWR, and the cross-polarization match our MEEP calculations.  These results indicate that our design is a linearly polarized, broadband RF horn antenna in the [5.5-6] GHz bandwidth.  Though our RF instrumenation is limited to frequencies $\leq 6$ GHz, our MEEP calculations predict good performance above 6 GHz.  Future work will include expanding the bandwidth with larger RF structures, and constructing a broadband RF phased array.}

% Keywords
\keyword{Computational Electromagnetism (CEM), Additive Manufacturing, MEEP, \\ RF Engineering, Open-Source Design}

\begin{document}

\section{Introduction}

Broadband RF antennas are ubiquitous tools within scientific instrumentation and communication applications.  Traditionally, RF antennas are designed using expensive, proprietary software packages, like XFDTD and HFSS \cite{hfss,xfdtd}.  Designs are fabricated by cutting and shaping metal with precision machine tools.  This technique is sometimes called \textit{subtractive manufacturing}, as opposed to \textit{additive manufacturing.}  Compared to \textit{additive manufacturing} techniques, subtractive manufacturing can be costly \cite{segoviaguerrero2025additive-29b,add_vs_sub}.  Open-source additive manufacturing boosts cost efficiency in both the design and fabrication of RF antennas, provided that the 3D printing filament has sufficient conductivity.

Development of new RF antenna designs requires exploration of conductor shapes that set the boundary conditions for radiated signals.  Developing new conductor shapes that meet design requirements has been aided by machine learning (ML) strategies \cite{gajbhiye2025comprehensive-fdb,goudos2016evolutionary-cc7,linden1999evolving-8c2}.  While mixing new ML algorithms into open CEM code is straightforward, incorporating them into proprietary software is often challenging and time-consuming.  Ideally, RF engineers would keep the functionality found in proprietary software to compute standard RF antenna metrics, while retaining the flexibility to incorporate new ML techniques.  Creating a design process based on open CEM tools achieves this goal.

Previously, J. C. Hanson (2021) demonstrated that the open-source MEEP software package may be used as an RF antenna design tool \cite{hanson2021broadband-cab}.  MEEP operates via the FDTD algorithm for Maxwell's Equations on a Yee lattice \cite{10.1016/j.cpc.2009.11.008}.  The key to the technique is that MEEP is written to account for the scale-invariance of Maxwell's Equations.  Even though MEEP is tradiationally used for designs with wavelengths at the $\mu$m scale, designs in with wavelengths at the cm scale may be created scaling length units within MEEP.  Specifically, J. C. Hanson produced RF phased array designs in two and three dimensions using MEEP functionality \cite{hanson2021broadband-cab}.  The designs included broadband RF horn elements in the [0.5-5] GHz bandwidth.  Further, J. C. Hanson demonstrated that open-source CAD software may be used to create complex designs that can be 3D printed \cite{meepcon_hanson}.

In recent years, RF antenna systems have begun to be fabricated using additive manufacturing technology.  The authors of \cite{alkaraki2020mmwave-bcd} presented a hybrid strategy that combined traditional PCB fabrication, non-conductive 3D printing, and metallization of 3D printed structures.  The assembled structure was a low-cost, electronically steerable MIMO array for mm-Wave 5G applications.  In another example, the authors of \cite{yoo2022hollow-9a5} produced a waveguide-fed holographic beam-forming antenna using a dual print-head 3D printing system that combined non-conductive PLA supports with conductive filament.  The result was a steerable beam at frequencies near 10 GHz.  The authors of \cite{yurduseven2017computational-82f} produced a Mills-Cross, frequency-diverse, metasurface antenna capable of electronic steering in the K-band, using a mixture of non-conductive PLA and conductive filament.  Finally, the authors of \cite{yurduseven20193d-68d} printed a holgraphic metasurface antenna using the same technique found in \cite{yurduseven2017computational-82f} for Fresnel-zone focusing on and off-axis in the X-band.

In this work, we present the first open-source, broadband, 3D printed RF horn, designed with MEEP and fabricated entirely from conductive 3D-printer filament.  In Sec. \ref{sec:mat_meth}, we explain the design, open-source CAD, and fabrication techniques.  In Sec. \ref{sec:results}, we show that the $\mathbf{E}$-plane and $\mathbf{H}$-plane radiation patterns, the VSWR, and the cross-polarization ratios match predictions.  In Sec. \ref{sec:conc}, we discuss the limitations of our analysis, summarize key results, and discuss applications and future directions for this research.

\section{Methods and Materials}
\label{sec:mat_meth}

The goal of this work was to use open CEM tools to design, model, and fabricate a linearly polarized, broadband RF horn antenna in the multi-GHz bandwidth.  We selected MEEP for our open CEM tools.  Over the past decade, MEEP has most often been used to design and model photonics systems \cite{hammond2022highperformance-057,majumder2017ultracompact-0fc}.  However, due to the scale-invariance of Maxwell's equations, MEEP may be used to model electromagnetic propagation with wavelengths at the cm-scale \cite{hanson2021broadband-cab,meepcon_hanson}.  Further, antenna designs created with open CAD tools like kLayout can be imported into MEEP.  Using parametric CAD design, we can specify antenna shapes using analytic functions that are then translated into kLayout and MEEP.  Designs in kLayout can also be translated into 3D printer files, ensuring we are simulating the same device we are fabricating.

Our open fabrication technique hinges on the existence of commerically available conductive 3D printer filament.  Multi3D\footnote{See \url{https://www.multi3dllc.com}} has shown that a copper-doped thermoplastic serves as a 3D printer filament with conductivities of $\approx 10^{-1}$ $\Omega$ cm, depending on the printing pattern.  Using a tungsten-tipped 3D printing head and Electrifi filament from Multi3D, we can complete antenna prints with 16 cm x 8.5 cm x 2.5 cm in several hours.  The printed structures are fitted with RF connectors and tested with a network analyzer, standardized metal antennas, and custom mounts.  Figure \ref{fig:1} (left) contains a flow diagram for the design and fabrication process.

\subsection{CEM Design and Open-Source CAD}
\label{sec:mat_meth_1}

The kLayout design of the RF horn is shown in Figure \ref{fig:1}.  The open-source CEM design begins with choosing parametric design parameters for the exponential RF horn.  The horn \textit{cavity} is the rectangular volume where the coaxial cable attaches.  The horn \textit{surfaces} are the curved structures that connect the cavity to open space.  The \textit{opening} is the area where the \textit{surfaces} stop and radiation exits the horn.  Let the origin of an $xy$ coordinate system refer to the center of the outside of the cavity.  Let $c_l$ refer to the cavity length in the $x$-direction, $c_w$ refer to the cavity width in the $y$-direction, $s_l$ refer to the surface length in the $x$-direction, and $w$ refer to the opening width in the $y$-direction.  Using these variables, Equations \ref{eq:1} and \ref{eq:2} specify the shape of the RF horn surfaces in the $xy$-plane:

\begin{align}
f(x) &= \frac{c_w}{2}\exp(k(x-c_l)) \label{eq:1} \\
k &= (s_l-c_l)^{-1} \ln\left(\frac{w}{c_w}\right) \label{eq:2}
\end{align}

\noindent
The function $f(x)$ in Equation \ref{eq:1} describes the upper surface in Figure \ref{fig:1}, while $-f(x)$ describes the lower surface.  Table \ref{tab:1} contains the values for $c_l$, $c_w$, $s_l$, and $w$ corresponding to our first 3D printed RF horn.  The horn is designed to be linearly polarized in the $y$-direction.  When we are using a three-dimensional CEM model, we give the RF horn a height $z$.  The $z$-direction is out of the page in Fig. \ref{fig:1} (right).

\begin{figure}
\centering
\includegraphics[width=0.65\textwidth]{CAD_path.pdf}
\includegraphics[width=0.34\textwidth]{CAD_1.png}
\caption{\label{fig:1} (Left) Flow diagram for the open-source design and fabrication process.  (Right) The kLayout CAD design for the RF horn (top view), with a coaxial cable attached.  The $x$-direction is to the right, the $y$-direction is up, and the $z$-direction is out of the page.}
\end{figure}

\begin{table}
\caption{\label{tab:1} Design parameters for the RF horn antenna.}
\begin{tabularx}{\textwidth}{CCC}
\toprule
\textbf{Parameter} & \textbf{Variable Name} & \textbf{Value [cm]} \\
\midrule
Cavity Length & $c_l$ & 0.77 \\
Cavity Width & $c_w$ & 1.00 \\
Surface Length & $s_l$ & 16.52 \\
Opening Width & $w$ & 9.59 \\
Height & z & 2.0 \\
\bottomrule
\end{tabularx}
\end{table}

In previous studies \cite{hanson2021broadband-cab}, antenna structures were instantiated as native MEEP objects.  For example, the following Python3 code with the Meep library imported as \verb+mp+ adds $N$ 2D exponential horns to the overall geometry via the \verb+mp.Block()+ method:

\small
\begin{verbatim}
for j in range(0,n_antenna):
    y = j*d_y+y0
    #Describe the cavity
    cav_back_location = mp.Vector3(x0,y)
    cav_location_pos = mp.Vector3(c_l/2.0+x0,c_w/2.0+y)
    cav_location_neg = mp.Vector3(c_l/2.0+x0,-c_w/2.0+y)
    backplate = mp.Block(backplate_size,center=cav_back_location,material=mp.metal)
    cav_upper = mp.Block(side_plate_size,center=cav_location_pos,material=mp.metal)
    cav_lower = mp.Block(side_plate_size,center=cav_location_neg,material=mp.metal)
    geometry.append(cav_upper)
    geometry.append(cav_lower)
    geometry.append(backplate)
    #Describe the horn surfaces
    size_upper = mp.Vector3(dx,thickness)
    size_lower = mp.Vector3(dx,thickness)
    for i in range(0,n_slices):
        center_upper = mp.Vector3(i*dx+c_l+x0,c_w/2*np.exp(k*(i*dx-c_l))+y)
        center_lower = mp.Vector3(i*dx+c_l+x0,-c_w/2*np.exp(k*(i*dx-c_l))+y)
        geometry.append(mp.Block(size_upper,center=center_upper,material=mp.metal))
        geometry.append(mp.Block(size_lower,center=center_lower,material=mp.metal))
\end{verbatim}
\normalsize

\noindent
With appropriate constants defined, this code creates a one-dimensional phased array of 2D RF horns with MEEP conductors.  There are two advantages to this \textit{parametric design}: it is fast and simple to code, and no other tools or programs outside of MEEP are required.  Structures can be quickly modified by exploring the parameter space defined by the constants in Table. \ref{tab:1}.  The disadvantage is that complex structures must be assembled from simple ones with little intuition or visualization.  Using open CAD programs like kLayout, however, allow the RF engineer to design antenna structures visually before importing them into MEEP.  By introducing open-source CAD, the same structures given to the CEM modeling can be given to the 3D printing system.

Ideally, the advantages of parametric design and open-source CAD should be preserved.  First, we print the vertices of the antenna structures from our Python3 code.  Second, we create polygons in kLayout, with initial lists of vertices.  Finally, we copy the vertices from Python3 code into the kLayout polygons.  This procedure results in 2D structures like those shown in Figure \ref{fig:1} (right).  Figure \ref{fig:1} (right) is a design of the RF horn in the $xy$-plane, and we give the design height and thickness in the $z$-direction after importing it to MEEP.  MEEP accepts the GDSII file format produced by kLayout, and GDSII files can be converted to STL files suitable for PrusaSlicer and other 3D printing software.

\subsubsection{Radiation Pattern Calculations}

We compute the antenna radiation pattern in MEEP using near-to-far field projection\footnote{See \url{https://meep.readthedocs.io/en/master/Python_Tutorials/Near_to_Far_Field_Spectra}}.  First, a \verb+NearToFarRegion+ is created to fully enclose the structure, similar to a Gaussian surface in classical electrodynamics.  Second, the \verb+get_farfield()+ function computes the $\mathbf{E}$ and $\mathbf{H}$ fields a distance $r$ from the origin.  In Figure \ref{fig:1}, the $xy$-plane is the $\mathbf{E}$-plane, and the $xz$-plane is the $\mathbf{H}$-plane.  We chose $r=10$ meters in our calculations, given the dimensions of the horn (Table. \ref{tab:1}) and $\approx 1$ cm wavelengths.  Third, we compute the normalized Poynting vector along the $\mathbf{E}$ and $\mathbf{H}$-planes.  The following code produces the normalized radiation pattern in dB, with MEEP as \verb+mp+, NumPy as \verb+np+, and \verb+proj_box+ as the \verb+NearToFarRegion+:

\small
\begin{verbatim}
def calculate_E_plane_rad_patt(sim,proj_box):
    r = 1000
    npts = 360
    E = np.zeros((npts,3),dtype=np.complex128)
    H = np.zeros((npts,3),dtype=np.complex128)
    angles = 2*np.pi/npts*np.arange(npts)
    for n in range(npts):
        x = r*np.cos(angles[n])
        y = r*np.sin(angles[n])
        ff = sim.get_farfield(proj_box,mp.Vector3(x,y,0))
        E[n,:] = [ff[j] for j in range(3)]
        H[n,:] = [ff[j+3] for j in range(3)]
    Px = np.real(np.conj(E[:,1])*H[:,2]-np.conj(E[:,2])*H[:,1])
    Py = np.real(np.conj(E[:,2])*H[:,0]-np.conj(E[:,0])*H[:,2])
    Pr = np.sqrt(np.square(Px) + np.square(Py))
    directivity = 10.0*np.log10(Pr/max(Pr))
    return (angles,directivity)
\end{verbatim}
\normalsize

\noindent
To obtain the radiation pattern from near-to-far field projection, the MEEP simulation must be run such that a sufficient amount of the radiation has passed through the \verb+NearToFarField+ region.

\subsubsection{VSWR Calculations}

\begin{figure}
\centering
\includegraphics[width=0.33\textwidth,trim=0cm 25cm 20cm 0cm,clip=true]{CAD_1.png}
\includegraphics[width=0.33\textwidth,trim=0cm 6cm 20cm 19cm,clip=true]{CAD_1.png}
\caption{\label{fig:2} (Left) The upper left region of \ref{fig:1}.  The purple region is the radiating source used for VSWR analysis, the red regions are dielectric material, and the light blue regions are conductors.  The combined structure represents a coaxial cable.  (Right)  The lower left region of \ref{fig:1}.  The coaxial cable reaches the horn cavity, shown in light blue.  The dark blue regions are the beginning of the horn surfaces.  The pink structure in the center is the radiation source used for radiation pattern analysis.}
\end{figure}

The voltage standing wave radio (VSWR) is a standard figure of merit in RF antenna characterization.  The VSWR may be expressed in terms of the complex reflection coefficient, $\Gamma$, between coaxial line and RF antenna input port:

\begin{equation}
VSWR = \frac{1+|\Gamma|}{1-|\Gamma|} \label{eq:3}
\end{equation}

\noindent
Our strategy to calculate the VSWR is to send a pulse signal down a model for a coaxial cable, and measure $\Gamma$.  This strategy is based on MEEP \verb+FluxRegion+ objects, similar to the \verb+NearToFarRegion+ objects in the previous section\footnote{See \url{https://meep.readthedocs.io/en/master/Python_Tutorials/GDSII_Import}.}.

Figure \ref{fig:2} (left) shows the upper left region of the RF horn CAD, depicting the radiation source within the structure representing the coaxial cable.  The coaxial cable model is built from outer conductors, dielectric materials, and an inner conductor with a radiating source polarized radially.  While the radiation pattern analysis uses a continuous-wave (CW) source, the source in our VSWR analysis is given a custom Gaussian signal with a broadband spectrum.  In the middle of the cable, a MEEP \verb+FluxRegion+ is instantiated.  Simular to a \verb+NearToFarRegion+, the \verb+FluxRegion+ records electromagnetic flux through a geometric region, simular to a Gaussian surface in classical electrodynamics.  Both MEEP classes can record flux at multiple frequencies.  In our CW radiation pattern analysis, we set the \verb+NearToFarRegion+ frequency to the source frequency.  In our VSWR analysis, we chose 1024 frequency bins ranging from [0-10] GHz and passed them to the \verb+FluxRegion+.

The reflection coefficient $\Gamma$ is measured in two stages.  First, the MEEP simulation is run for a time corresponding to the length of the coaxial cable, accounting for the speed of propagation given the dielectric material.  The input flux is recorded, and the simulation is reset.  The simulation is run a second time, but the input flux is multiplied by $-1$ and pre-loaded into the \verb+FluxRegion+.  The simulation is run for a factor of 2 longer, so that any reflections from the RF antenna have time to reach the \verb+FluxRegion+ a second time.  The \verb+FluxRegion+ records the output flux, having already cancelled the input flux from the pre-loaded opposite input flux.  Thus, using one \verb+FluxRegion+, the ratio of output to input flux, $\Gamma$, can be calculated.  The VSWR ratio (Equation \ref{eq:3}) is formed and converted to dB.

\subsection{Fabrication Technique}
\label{sec:mat_meth_3}

The 3D printed RF horn was designed using Autodesk Inventor with free Education Plan.  The equations that decribe the RF horn, Eqs. \ref{eq:1} and \ref{eq:2}, can be implemented with the parameters in Tab. \ref{tab:1} using the Equation Curve feature.  Inventor uses parametric modeling, meaning parameters from Tab. \ref{tab:1} can be edited to produce new designs.  Merging the mathematical form of Eqs. \ref{eq:1} and \ref{eq:2} required parameterization into a format useable by the Equation Curve feature.  Other challenges that are unique to this process involve maintaining geometric design constraints.  Since adjusting parameters or design offsets may result in a design that violates a design constraint, the process required fine tuning.

The 3D print workflow requires careful consideration.  The Multi3D Electrifi filament was found to be more difficult to print than PLA or PETG.  The tall and narrow nature of the model produced issues with build plate adhesion.  To address this, two steps were added to the workflow: glue from a glue stick or spray can was applied to a layer of masking tape on the print bed, and removable buttresses were added to the print structure.  The filament was printed between 135-145 degrees C, and no bed heating was required.  Our printer is a dual print-head Prusa XL, with a modified tungsten tipped nozzle to reduce abrasion.  The slicing program used to translate from CAD to printer firmware was PrusaSlicer, which has a method for including custom firmware commands.  Crucially, a custom command was required to allow the printer to print below its minimum safety temperature.

\subsection{Computational Hardware}
\label{sec:computational}

\section{Results}
\label{sec:results}

Using the techniques described in Sec. \ref{sec:mat_meth_3}, we fabricated an RF horn with the parameters in Table \ref{tab:1}.  Figure \ref{fig:3} contains photos of the results.  As listed in Table \ref{tab:1}, the RF horn is 16.5 cm long (see ruler in Figure \ref{fig:3}).  The dimensions of the opening are 2.5 x 8.5 cm.  The SMA connector is mounted to the cavity, with a coaxial pin extending into the chamber such that the initial radiation is linearly polarized.  The radiation pattern measurements were made in a co-polarized S21 configuration, and VSWR measurements are made with respect to a 50 $\Omega$ RF coaxial cable connected to printed RF horn.

\begin{figure}
\centering
\includegraphics[width=0.25\textwidth,angle=90]{antenna_1.jpg}
\includegraphics[width=0.45\textwidth]{antenna_2.jpg}
\caption{\label{fig:3} (Left) The Prusa XL 3D printer beginning a print with the Electrifi filament. (Middle) The finished RF horn with SMA connector. (Right) The finished RF horn viewed with opening visible.}
\end{figure}

\subsection{Radiation Patterns}
\label{sec:results_1}

To measure the radiation patterns of the RF horn, we bolted the RF horn on a camera mount, and configured it as the receiver into a network analyzer with [0-6] GHz bandwidth (Fig. \ref{fig:4}).  For a transmitter, we used a rear-fed log-periodic dipole array (LPDA).  The netork analyzer was calibrated with a short element, open element, and 50 $\Omega$ terminator.  After calibration, the S21 measurement mode was activated, and the cables were connected together to form a closed loop without the antennas.  The measured S21 showed a 0 dB loss across the 6 GHz bandwidth.  The receiver and transmitter where then inserted, and the S21 measured versus frequency.  The transmitter power was set to maximum, 20 dBm, meaning no amplifier was necessary.  The distance between transmitter and receiver varied between 1-2 meters.  Received power was measured above the noise floor in the bandwidth [5.5-6] GHz

\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{antennas_s12.jpg}
\caption{\label{fig:4} The co-polarized configuration to measure the radiation pattern of the printed RF horn.}
\end{figure}

We first verified qualitatively that the S21 power varied appropriately with $\mathbf{E}$-plane angle, $\mathbf{H}$-plane angle, and co-polarization angle.  Next, the receiver and transmitter were mounted in a vertically polarized configuration so that $\mathbf{E}$-plane angle could be measured with a smartphone level tool (Figure \ref{fig:4}).  The S21 power was measured versus $\mathbf{E}$-plane angle.  Next, the antennas were mounted in a horizontally polarized configuration, so that $\mathbf{H}$-plane angle could be measured with the same smartphone tool.  The S21 power was normalized to the maximum received power, when $\mathbf{E}$-plane and $\mathbf{H}$-plane angle were both 0 degrees.  The results are shown in Figure \ref{fig:5}.

\begin{figure}[h]
\centering
\includegraphics[width=0.4\textwidth,trim=2cm 0cm 2cm 0cm,clip=true]{rad_pattern_5.967GHz_Eplane.png}
\includegraphics[width=0.4\textwidth,trim=2cm 0cm 2cm 0cm,clip=true]{rad_pattern_5.85GHz_Hplane.png}
\caption{\label{fig:5} (Left) Black circles: the $\mathbf{E}$-plane radiation pattern data (5.967 GHz).  Black line: 3D MEEP simulation of $\mathbf{E}$-plane radiation pattern.  (Right) Black crosses: the $\mathbf{H}$-plane radiation pattern data (5.85 GHz). Black line: 3D MEEP simulation of $\mathbf{H}$-plane radiation pattern.}
\end{figure}

The polar plot ranges from -26 dB to 1 dB in normalized power.  In the spherical coordinate system for an RF antenna radiating in the $x$-direction, linearly polarized in the $y$-direction, the $\mathbf{E}$-plane angle is the azimuthal angle as measured from the $x$-axis.  Thus, in Figure \ref{fig:5} (left) the data and CEM model peak at 0 dB when the angle is 0 degrees.  There is good agreement between the CEM model and the measured S21 power.  In the same coordinate system, the zenith angle is the $\mathbf{H}$-plane angle.  Thus, in Figure \ref{fig:5} (right) the data and CEM model peak at 0 dB when the angle is 90 degrees.  As with the $\mathbf{E}$-plane, there is good agreement between the CEM model and S21 power.

\subsection{The VSWR}
\label{sec:results_2}

To measure the VSWR of the RF horn, we bolted the RF horn to the camera mount, and configured it as the transmitter on the network analyzer.  Once again, the network analyzer was calibrated on [0-6] GHz.  After calibration, the S11 measurement mode was activated, and we verified that we measured 50 $\Omega$ resistance in the bandwidth of interest.  Finally, we extracted the S11 reflection coefficient in dB from the network analyzer.  We took two additional post-processing steps.  First, we converted S11 in dB to linear S11, and then to VSWR using Equation \ref{eq:3}.  Second, we smoothed the data with an 11-point running average.  We chose the 11-point filter to remain symmetric about the sample of interest (5 points to either side).  Though the S11 fluctuated, the 11-point running average revealed a trend that matches results from CEM modeling.  The results are shown in Figure \ref{fig:6}.

\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{vswr_12percentSmoothing_ext.pdf}
\caption{\label{fig:6} Circles: measured VSWR data, smoothed with a running average filter.  Line: VSWR from CEM modeling.  The black circles have been shifted down to account for the impedance mismatch between 3D printed RF horn and coaxial cable. See text for details.}
\end{figure}

After the two-stage post-processing, the VSWR from CEM modeling matched the measured VSWR once we shifted the measured VSWR down by a factor of 4.  The reason for this is the impedance mismatch between the line impedance from the coaxial cable, and the load impedance from the RF horn.  For example, if $Z_{\rm ant} = 200 \Omega$, and $Z_{\rm L} = 50 \Omega$, then the VSWR is a factor of 4 higher than it would be if the antenna were matched to the line ($Z_{\rm ant} = 50 \Omega$).  Though the measured $Z_{\rm ant}$ fluctuated between 50-200 $\Omega$, after converting to VSWR and scaling the data, we find a match to CEM.  Two additional observations are important to note.  First, our VSWR calculation in MEEP was performed in 2D.  This makes the calculation simpler, but it is not necessary.  Second, the bandwidth of the network analyzer was limited to 6 GHz.  Though our measured data stops at 6 GHz in Figure \ref{fig:6}, the simulated VSWR in Figure \ref{fig:6} predicts good performance above 6 GHz.

\subsection{Cross-Polarization Ratios}
\label{sec:results_3}

The final measurement we performed was the cross-polarization ratio.  The 3D printed RF horn and LPDA were arranged in the same S21 configuration that was used to measure the radiation patterns.  The RF horn was the receiver, and bolted to the mount such that an inclinometer would measure cross-polarization angle.  The prediction for the dependence of received power versus cross-polarization angle is known from optics and antenna theory.  Let $P_{\rm r}$ be the received power, $P_{\rm t}$ be the transmitted power, and $\theta$ be the cross-polarization angle.  These are related by

\begin{equation}
P_{\rm r} = P_{\rm t} \cos^2\theta \label{eq:4}
\end{equation}

\noindent
When normalized, the ratio $P_{\rm r}/P_{\rm t}$ in dB is equivalent to normalized S21.  The results are shown in Figure \ref{fig:7}, and show good agreement between data and CEM modeling.

\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{crosspol_5.80GHz.pdf}
\caption{\label{fig:7} Circles: measured cross-polarization ratio in dB relative to maximum power.  Line:  Prediction from Equation \ref{eq:4}.}
\end{figure}

\subsection{Future Work: Expansion of Bandwidth via Scaled Design}
\label{sec:results_4}

One limitation of our current 3D printed RF horn is measuring the lower edge of the bandwidth.  While the data in Fig. \ref{fig:6} show equally efficient performance between [4-6] GHz, in practice, measuring S21 below 5.5 GHz is challenging due to decreased SNR at lower frequencies.  We have scaled our RF horn design by a factor of 2, and are currently completing our first prints of this larger device.  The predicted VSWR is shown in Fig. \ref{fig:8}, along with the VSWR corresponding to the open RF cable model and no RF horn.

\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{scaled_vswr.pdf}
\caption{\label{fig:8} Black circles: the VSWR data from Fig. \ref{fig:6}, with frequencies scaled down by a factor of 2.  Solid black line: VSWR from MEEP simulation using a CAD model scaled by a factor of 2.  Dashed line: the VSWR from MEEP simulation with RF cable and no RF horn.}
\end{figure}

In Fig. \ref{fig:8}, the VSWR data from Fig. \ref{fig:6} is again plotted, but the frequencies have been scaled down by a factor of 2, corresponding to the larger 3D print design.  The MEEP simulation uses an identical CAD file that has been scaled accordingly in kLayout, using the Scale feature.  The data again matches the simulation.  The dashed line represents the VSWR result if the RF horn structure is removed, leaving only the original RF cable.  Only the highest frequencies radiate efficiently from the cable model.  The MEEP simulation shows that a larger model should have better performance at low frequencies, and that a bandwidth of [1-6] GHz is expected.

\section{Conclusions}
\label{sec:conc}

The goal of this research is to demonstrate a fully open-source design and fabrication process for broadband RF phased arrays.  The elimination of proprietary design software and the introduction of versitile 3D printing with conductive filament will enhance RF phased array production in two ways.  First, gains in cost-efficiency arise from the use of open-source tools and printing techniques.  Second, new designs can be realized through innovative additive manufacturing techniques, rather than relying on traditional metal machining.  We made progress towards these goals by producing our first fully open-source, 3D printed, broadband, linearly polarized RF horn.  This is one of the first examples of a 3D printed broadband RF element using no metallization or post-printing procedures.

First, we shared example code that creates a 2D version of our 3D model using MEEP objects.  We also shared how radiation patterns are calculated using MEEP algorithms, and outlined how we calculate the VSWR.  We have created and run full 3D versions of the MEEP code used to produce the design calculations on our parallel HPC system.  For 3D CAD, we selected kLayout to create detailed models of the RF horn that can be imported as MEEP structures.  Our kLayout designs are also translated to AutoDesk Inventor (Free education version).  Thus, we simulate the same system that we fabricate, within the precision of the 3D printer (about 0.2 mm).  The simulation results behave as expected, and can be modified by changing the parameters within our parametric design.  Finally, we measured the radiation patterns in the $\mathbf{E}$ and $\mathbf{H}$ planes, and the smoothed VSWR.  The measured radiation patterns and VSWR match our 3D MEEP calculations.

The natural direction of the work is to expand RF bandwidth by enlarging the RF horn design, and to explore and optimize alternate designs in MEEP.  Further, we seek to print a set of $N$ identical broadband RF elements to form a broadband RF phased array, as envisioned in \cite{hanson2021broadband-cab}.  Finally, we seek to explore \textit{operating} the broadband RF phased array in a multibeam mode, using complex broadband source signals.

\vspace{6pt} 

\authorcontributions{J. C. Hanson (JCH) conceived of the open-source design process and produced the initial MEEP calculations that led to the RF horn design, including a previous publication in \textit{Electronics Journal}.  JCH identified the conductive 3D printer filament with sufficient conductivity to fabricate RF antennas.  JCH demonstrated that open-source CAD can be incorporated into the process.  Finally, JCH produced fully three-dimensional CEM models using MEEP to compute the VSWR and radiation patterns for the fabricated designs.  A. Wildanger (AW) sourced materials, and imported CAD designs into 3D printing format.  AW successfully completed 3D prints to produce the designs.  Together, JCH and AW collected data using the RF measurement tools.  JCH used the data to show that the MEEP calculations match the lab measurements.  AW is exploring new models to be printed using open-source and free CAD programs, including larger RF horn models.}

\funding{This work was supported by NEEC grant N00178-25-0001 through NSWC Corona.  Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author and do not necessarily reflect the views of NSWC Corona or the Department of the Navy.}

\dataavailability{Code and other resources available at \url{https://github.com/918particle/Antenna-MEEP-project}.} 

\acknowledgments{Acknowledge Lisa Newton and Sal Johnston}

\conflictsofinterest{The authors declare no conflicts of interest.} 

\abbreviations{Abbreviations}{
The following abbreviations are used in this manuscript:
\\
\noindent 
\begin{tabular}{@{}ll}
CEM & Computational Electromagnetism \\
CW & Continuous Wave \\
MEEP & MIT Electromagnetic Equation Propagator \\
NEEC & Naval Engineering Education Consortium \\
NSWC Corona & Naval Surface Warfare Center, Corona Division \\
RF & Radio-frequency \\
LPDA & Log-periodic Dipole Array \\
PLA & Polylactice Acid \\
PETG & Polyethylene Glycol 
\end{tabular}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Optional
%\appendixtitles{no} % Leave argument "no" if all appendix headings stay EMPTY (then no dot is printed after "Appendix A"). If the appendix sections contain a heading then change the argument to "yes".
%\appendixstart
%\appendix
%\section[\appendixname~\thesection]{}
%The appendix is an optional section that can contain details and data supplemental to the main text
%\section[\appendixname~\thesection]{}
%All appendix sections must be cited in the main text. 

\begin{adjustwidth}{-\extralength}{0cm}

\reftitle{References}

\bibliography{references}

\PublishersNote{}
\end{adjustwidth}
\end{document}
